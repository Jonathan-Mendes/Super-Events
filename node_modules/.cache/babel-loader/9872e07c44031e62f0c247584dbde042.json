{"ast":null,"code":"var _jsxFileName = \"/home/jonathan/\\xC1rea de Trabalho/Super-Events/src/components/Perfil/index.js\";\nimport React, { Component } from 'react';\nimport firebase from '../../firebase';\nimport { Container, Row, Col, Button, Input, Label, Progress, Form, FormGroup } from 'reactstrap';\nimport InputMask from 'react-input-mask';\nimport './perfil.css';\n\nclass Perfil extends Component {\n  constructor(props) {\n    super(props);\n\n    this.update = async () => {\n      let users = firebase.app.ref('usuarios');\n\n      try {\n        await users.child(this.state.uid).update({\n          foto: this.state.foto,\n          nome: this.state.nome,\n          cpf: this.state.cpf\n        });\n        this.setState(this.state); // alert(\"Seus dados foram salvos com sucesso!\")\n\n        window.location.reload();\n      } catch (error) {\n        alert(\"Ocorreu um erro ao alterar seus dados!\");\n      }\n    };\n\n    this.handleFile = async e => {\n      if (e.target.files[0]) {\n        const image = e.target.files[0];\n\n        if (image.type === \"image/png\" || image.type === \"image/jpeg\") {\n          await this.setState({\n            imagem: image\n          });\n          this.handleUpload();\n        } else {\n          alert('Envie uma imagem do tipo PNG ou JPEG');\n          this.setState({\n            imagem: null\n          });\n          return null;\n        }\n      }\n    };\n\n    this.handleUpload = async () => {\n      const imagem = this.state.imagem;\n      const currentUid = firebase.getCurrentUid();\n      const uploadTask = firebase.storage.ref(\"images/\".concat(currentUid, \"/\").concat(imagem.name)).put(imagem);\n      await uploadTask.on('state_changed', snapshot => {\n        //Progress\n        const progress = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n        this.setState({\n          progress: progress\n        });\n      }, error => {\n        //Error\n        console.log('Error imagem: ' + error);\n      }, () => {\n        //Sucessful\n        firebase.storage.ref(\"images/\".concat(currentUid)).child(imagem.name).getDownloadURL().then(url => {\n          this.setState({\n            foto: url\n          });\n        });\n      });\n    };\n\n    this.onChange = event => {\n      var value = event.target.value;\n      var newState = {\n        mask: '999.999.999-99',\n        value: value\n      };\n\n      if (/^3[47]/.test(value)) {\n        newState.mask = '999.999.999-99';\n      }\n\n      this.setState(newState);\n      this.setState({\n        cpf: event.target.value\n      });\n    };\n\n    this.state = {\n      mask: '999.999.999-99',\n      foto: null,\n      nome: '',\n      cpf: '',\n      fotoOld: '',\n      nomeOld: '',\n      cpfOld: '',\n      email: firebase.getCurrent(),\n      uid: firebase.getCurrentUid(),\n      progress: 0\n    };\n    this.alterar = this.alterar.bind(this);\n    this.salvar = this.salvar.bind(this);\n    this.cancelar = this.cancelar.bind(this);\n    this.controlaTela = this.controlaTela.bind(this);\n    this.update = this.update.bind(this);\n    this.handleFile = this.handleFile.bind(this);\n    this.handleUpload = this.handleUpload.bind(this);\n    this.validarCPF = this.validarCPF.bind(this);\n  }\n\n  async componentDidMount() {\n    let elements = document.getElementsByClassName('edit');\n    elements[0].disabled = true; //Input File\n\n    elements[1].disabled = true; //Input Name\n\n    elements[2].disabled = true; //Input CPF\n\n    elements[3].disabled = true; //Button Salvar\n\n    elements[4].disabled = true; //Button Cancelar\n\n    console.log(elements);\n    firebase.getUserName(info => {\n      localStorage.nome = info.val().nome;\n      localStorage.cpf = info.val().cpf;\n      localStorage.foto = info.val().foto;\n      this.setState({\n        nome: localStorage.nome,\n        foto: localStorage.foto,\n        cpf: localStorage.cpf\n      });\n    });\n  }\n\n  salvar(e) {\n    this.controlaTela(e);\n\n    if (this.validarCPF(this.state.cpf)) {\n      this.update();\n    } else {\n      alert(\"CPF Inválido!\");\n      this.setState({\n        foto: this.state.fotoOld,\n        nome: this.state.nomeOld,\n        cpf: this.state.cpfOld\n      });\n    }\n  }\n\n  cancelar(e) {\n    this.setState({\n      progress: 0\n    });\n    this.controlaTela(e);\n    this.setState({\n      foto: this.state.fotoOld,\n      nome: this.state.nomeOld,\n      cpf: this.state.cpfOld\n    });\n  }\n\n  alterar(e) {\n    this.controlaTela(e);\n    this.state.nomeOld = this.state.nome;\n    this.state.cpfOld = this.state.cpf;\n    this.state.fotoOld = this.state.foto;\n  }\n\n  controlaTela(cond) {\n    let elements = document.getElementsByClassName('edit');\n    elements[0].disabled = !cond; //Input File\n\n    elements[1].disabled = !cond; //Input Nome\n\n    elements[2].disabled = !cond; //Input CPF\n\n    elements[3].disabled = !cond; //Button Salvar\n\n    elements[4].disabled = !cond; //Button Cancelar\n\n    elements[5].disabled = cond; //Button Alterar\n  }\n\n  validarCPF(cpf) {\n    cpf = cpf.replace(/[^\\d]+/g, '');\n    let rev;\n    let add;\n    if (cpf == '') return false;\n    if (cpf.length != 11 || cpf == \"00000000000\" || cpf == \"11111111111\" || cpf == \"22222222222\" || cpf == \"33333333333\" || cpf == \"44444444444\" || cpf == \"55555555555\" || cpf == \"66666666666\" || cpf == \"77777777777\" || cpf == \"88888888888\" || cpf == \"99999999999\") return false;\n    add = 0;\n\n    for (let i = 0; i < 9; i++) add += parseInt(cpf.charAt(i)) * (10 - i);\n\n    rev = 11 - add % 11;\n    if (rev == 10 || rev == 11) rev = 0;\n    if (rev != parseInt(cpf.charAt(9))) return false;\n    add = 0;\n\n    for (let i = 0; i < 10; i++) add += parseInt(cpf.charAt(i)) * (11 - i);\n\n    rev = 11 - add % 11;\n    if (rev == 10 || rev == 11) rev = 0;\n    if (rev != parseInt(cpf.charAt(10))) return false;\n    return true;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(Container, {\n      className: \"mx-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(Row, {\n      className: \"mt-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: \"12\",\n      sm: \"12\",\n      md: \"12\",\n      lg: \"12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      id: \"title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"Meu Perfil\"))), React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(Col, {\n      md: \"12\",\n      lg: \"12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, React.createElement(Form, {\n      id: \"perfil\",\n      className: \"my-2 mx-auto rounded\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(FormGroup, {\n      className: \"d-flex justify-content-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"rounded-circle my-1 myBorder\",\n      width: \"200px\",\n      height: \"200px\",\n      src: this.state.foto,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    })), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(Input, {\n      type: \"file\",\n      className: \"edit mx-auto my-3\",\n      onChange: this.handleFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }), React.createElement(Progress, {\n      id: \"progress\",\n      color: \"success\",\n      className: \" mx-auto\",\n      value: this.state.progress,\n      max: \"100\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    })), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"nome\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, \"Nome\"), React.createElement(Input, {\n      id: \"nome\",\n      type: \"text\",\n      className: \" my-1 mx-auto edit\",\n      value: this.state.nome,\n      onChange: e => this.setState({\n        nome: e.target.value\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    })), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"cpf\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }, \"CPF\"), React.createElement(InputMask, Object.assign({\n      id: \"cpf\",\n      className: \"form-control my-1 mx-auto edit\"\n    }, this.state, {\n      onChange: this.onChange,\n      id: \"cpf\",\n      value: this.state.cpf,\n      autoComplete: \"off\",\n      placeholder: \"000.000.000-00\",\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239\n      },\n      __self: this\n    }))), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(Col, {\n      sm: \"12\",\n      md: \"\",\n      lg: \"4\",\n      className: \"text-center my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"success\",\n      className: \"edit w-100\",\n      onClick: e => this.salvar(false),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }, \"Salvar\")), React.createElement(Col, {\n      sm: \"12\",\n      md: \"4\",\n      lg: \"4\",\n      className: \"text-center my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"danger\",\n      className: \"edit w-100\",\n      onClick: e => {\n        this.cancelar(false);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, \"Cancelar\")), React.createElement(Col, {\n      sm: \"12\",\n      md: \"4\",\n      lg: \"4\",\n      className: \"text-center my-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, React.createElement(Button, {\n      color: \"warning\",\n      className: \"edit w-100\",\n      onClick: e => this.alterar(true),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, \"Alterar\")))))))));\n  }\n\n}\n\nexport default Perfil;","map":{"version":3,"sources":["/home/jonathan/Área de Trabalho/Super-Events/src/components/Perfil/index.js"],"names":["React","Component","firebase","Container","Row","Col","Button","Input","Label","Progress","Form","FormGroup","InputMask","Perfil","constructor","props","update","users","app","ref","child","state","uid","foto","nome","cpf","setState","window","location","reload","error","alert","handleFile","e","target","files","image","type","imagem","handleUpload","currentUid","getCurrentUid","uploadTask","storage","name","put","on","snapshot","progress","Math","round","bytesTransferred","totalBytes","console","log","getDownloadURL","then","url","onChange","event","value","newState","mask","test","fotoOld","nomeOld","cpfOld","email","getCurrent","alterar","bind","salvar","cancelar","controlaTela","validarCPF","componentDidMount","elements","document","getElementsByClassName","disabled","getUserName","info","localStorage","val","cond","replace","rev","add","length","i","parseInt","charAt","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,SAASC,SAAT,EAAoBC,GAApB,EAAyBC,GAAzB,EAA8BC,MAA9B,EAAsCC,KAAtC,EAA6CC,KAA7C,EAAoDC,QAApD,EAA8DC,IAA9D,EAAoEC,SAApE,QAAqF,YAArF;AACA,OAAOC,SAAP,MAAsB,kBAAtB;AACA,OAAO,cAAP;;AACA,MAAMC,MAAN,SAAqBZ,SAArB,CAA+B;AAE3Ba,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SA0CnBC,MA1CmB,GA0CV,YAAY;AACjB,UAAIC,KAAK,GAAGf,QAAQ,CAACgB,GAAT,CAAaC,GAAb,CAAiB,UAAjB,CAAZ;;AAEA,UAAI;AACA,cAAMF,KAAK,CAACG,KAAN,CAAY,KAAKC,KAAL,CAAWC,GAAvB,EAA4BN,MAA5B,CAAmC;AACrCO,UAAAA,IAAI,EAAE,KAAKF,KAAL,CAAWE,IADoB;AAErCC,UAAAA,IAAI,EAAE,KAAKH,KAAL,CAAWG,IAFoB;AAGrCC,UAAAA,GAAG,EAAE,KAAKJ,KAAL,CAAWI;AAHqB,SAAnC,CAAN;AAKA,aAAKC,QAAL,CAAc,KAAKL,KAAnB,EANA,CAOA;;AACAM,QAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH,OATD,CASE,OAAOC,KAAP,EAAc;AACZC,QAAAA,KAAK,CAAC,wCAAD,CAAL;AACH;AACJ,KAzDkB;;AAAA,SAuGnBC,UAvGmB,GAuGN,MAAOC,CAAP,IAAa;AAEtB,UAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,EAAuB;AACnB,cAAMC,KAAK,GAAGH,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAd;;AAEA,YAAIC,KAAK,CAACC,IAAN,KAAe,WAAf,IAA8BD,KAAK,CAACC,IAAN,KAAe,YAAjD,EAA+D;AAC3D,gBAAM,KAAKX,QAAL,CAAc;AAAEY,YAAAA,MAAM,EAAEF;AAAV,WAAd,CAAN;AACA,eAAKG,YAAL;AACH,SAHD,MAGO;AACHR,UAAAA,KAAK,CAAC,sCAAD,CAAL;AACA,eAAKL,QAAL,CAAc;AAAEY,YAAAA,MAAM,EAAE;AAAV,WAAd;AACA,iBAAO,IAAP;AACH;AACJ;AACJ,KArHkB;;AAAA,SAuHnBC,YAvHmB,GAuHJ,YAAY;AAAA,YACfD,MADe,GACJ,KAAKjB,KADD,CACfiB,MADe;AAEvB,YAAME,UAAU,GAAGtC,QAAQ,CAACuC,aAAT,EAAnB;AACA,YAAMC,UAAU,GAAGxC,QAAQ,CAACyC,OAAT,CACdxB,GADc,kBACAqB,UADA,cACcF,MAAM,CAACM,IADrB,GAEdC,GAFc,CAEVP,MAFU,CAAnB;AAIA,YAAMI,UAAU,CAACI,EAAX,CAAc,eAAd,EACDC,QAAD,IAAc;AACV;AACA,cAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAYH,QAAQ,CAACI,gBAAT,GAA4BJ,QAAQ,CAACK,UAAtC,GAAoD,GAA/D,CAAjB;AACA,aAAK1B,QAAL,CAAc;AAAEsB,UAAAA,QAAQ,EAAEA;AAAZ,SAAd;AACH,OALC,EAMDlB,KAAD,IAAW;AACP;AACAuB,QAAAA,OAAO,CAACC,GAAR,CAAY,mBAAmBxB,KAA/B;AACH,OATC,EAUF,MAAM;AACF;AACA5B,QAAAA,QAAQ,CAACyC,OAAT,CAAiBxB,GAAjB,kBAA+BqB,UAA/B,GACKpB,KADL,CACWkB,MAAM,CAACM,IADlB,EAEKW,cAFL,GAGKC,IAHL,CAGUC,GAAG,IAAI;AACT,eAAK/B,QAAL,CAAc;AAAEH,YAAAA,IAAI,EAAEkC;AAAR,WAAd;AACH,SALL;AAMH,OAlBC,CAAN;AAmBH,KAjJkB;;AAAA,SAmJnBC,QAnJmB,GAmJPC,KAAD,IAAW;AAClB,UAAIC,KAAK,GAAGD,KAAK,CAACzB,MAAN,CAAa0B,KAAzB;AACA,UAAIC,QAAQ,GAAG;AACXC,QAAAA,IAAI,EAAE,gBADK;AAEXF,QAAAA,KAAK,EAAEA;AAFI,OAAf;;AAIA,UAAI,SAASG,IAAT,CAAcH,KAAd,CAAJ,EAA0B;AACtBC,QAAAA,QAAQ,CAACC,IAAT,GAAgB,gBAAhB;AACH;;AACD,WAAKpC,QAAL,CAAcmC,QAAd;AACA,WAAKnC,QAAL,CAAc;AAAED,QAAAA,GAAG,EAAEkC,KAAK,CAACzB,MAAN,CAAa0B;AAApB,OAAd;AACH,KA9JkB;;AAEf,SAAKvC,KAAL,GAAa;AACTyC,MAAAA,IAAI,EAAE,gBADG;AAETvC,MAAAA,IAAI,EAAE,IAFG;AAGTC,MAAAA,IAAI,EAAE,EAHG;AAITC,MAAAA,GAAG,EAAE,EAJI;AAKTuC,MAAAA,OAAO,EAAE,EALA;AAMTC,MAAAA,OAAO,EAAE,EANA;AAOTC,MAAAA,MAAM,EAAE,EAPC;AAQTC,MAAAA,KAAK,EAAEjE,QAAQ,CAACkE,UAAT,EARE;AAST9C,MAAAA,GAAG,EAAEpB,QAAQ,CAACuC,aAAT,EATI;AAUTO,MAAAA,QAAQ,EAAE;AAVD,KAAb;AAYA,SAAKqB,OAAL,GAAe,KAAKA,OAAL,CAAaC,IAAb,CAAkB,IAAlB,CAAf;AACA,SAAKC,MAAL,GAAc,KAAKA,MAAL,CAAYD,IAAZ,CAAiB,IAAjB,CAAd;AACA,SAAKE,QAAL,GAAgB,KAAKA,QAAL,CAAcF,IAAd,CAAmB,IAAnB,CAAhB;AACA,SAAKG,YAAL,GAAoB,KAAKA,YAAL,CAAkBH,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKtD,MAAL,GAAc,KAAKA,MAAL,CAAYsD,IAAZ,CAAiB,IAAjB,CAAd;AACA,SAAKtC,UAAL,GAAkB,KAAKA,UAAL,CAAgBsC,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAK/B,YAAL,GAAoB,KAAKA,YAAL,CAAkB+B,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKI,UAAL,GAAkB,KAAKA,UAAL,CAAgBJ,IAAhB,CAAqB,IAArB,CAAlB;AACH;;AAED,QAAMK,iBAAN,GAA0B;AAEtB,QAAIC,QAAQ,GAAGC,QAAQ,CAACC,sBAAT,CAAgC,MAAhC,CAAf;AACAF,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,IAAvB,CAHsB,CAGM;;AAC5BH,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,IAAvB,CAJsB,CAIM;;AAC5BH,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,IAAvB,CALsB,CAKM;;AAC5BH,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,IAAvB,CANsB,CAMM;;AAC5BH,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,IAAvB,CAPsB,CAOM;;AAC5B1B,IAAAA,OAAO,CAACC,GAAR,CAAYsB,QAAZ;AAEA1E,IAAAA,QAAQ,CAAC8E,WAAT,CAAsBC,IAAD,IAAU;AAC3BC,MAAAA,YAAY,CAAC1D,IAAb,GAAoByD,IAAI,CAACE,GAAL,GAAW3D,IAA/B;AACA0D,MAAAA,YAAY,CAACzD,GAAb,GAAmBwD,IAAI,CAACE,GAAL,GAAW1D,GAA9B;AACAyD,MAAAA,YAAY,CAAC3D,IAAb,GAAoB0D,IAAI,CAACE,GAAL,GAAW5D,IAA/B;AACA,WAAKG,QAAL,CAAc;AAAEF,QAAAA,IAAI,EAAE0D,YAAY,CAAC1D,IAArB;AAA2BD,QAAAA,IAAI,EAAE2D,YAAY,CAAC3D,IAA9C;AAAoDE,QAAAA,GAAG,EAAEyD,YAAY,CAACzD;AAAtE,OAAd;AACH,KALD;AAMH;;AAmBD8C,EAAAA,MAAM,CAACtC,CAAD,EAAI;AACN,SAAKwC,YAAL,CAAkBxC,CAAlB;;AACA,QAAI,KAAKyC,UAAL,CAAgB,KAAKrD,KAAL,CAAWI,GAA3B,CAAJ,EAAqC;AACjC,WAAKT,MAAL;AACH,KAFD,MAGK;AACDe,MAAAA,KAAK,CAAC,eAAD,CAAL;AACA,WAAKL,QAAL,CAAc;AACVH,QAAAA,IAAI,EAAE,KAAKF,KAAL,CAAW2C,OADP;AAEVxC,QAAAA,IAAI,EAAE,KAAKH,KAAL,CAAW4C,OAFP;AAGVxC,QAAAA,GAAG,EAAE,KAAKJ,KAAL,CAAW6C;AAHN,OAAd;AAKH;AACJ;;AAEDM,EAAAA,QAAQ,CAACvC,CAAD,EAAI;AACR,SAAKP,QAAL,CAAc;AAAEsB,MAAAA,QAAQ,EAAE;AAAZ,KAAd;AAEA,SAAKyB,YAAL,CAAkBxC,CAAlB;AACA,SAAKP,QAAL,CAAc;AACVH,MAAAA,IAAI,EAAE,KAAKF,KAAL,CAAW2C,OADP;AAEVxC,MAAAA,IAAI,EAAE,KAAKH,KAAL,CAAW4C,OAFP;AAGVxC,MAAAA,GAAG,EAAE,KAAKJ,KAAL,CAAW6C;AAHN,KAAd;AAKH;;AAEDG,EAAAA,OAAO,CAACpC,CAAD,EAAI;AACP,SAAKwC,YAAL,CAAkBxC,CAAlB;AACA,SAAKZ,KAAL,CAAW4C,OAAX,GAAqB,KAAK5C,KAAL,CAAWG,IAAhC;AACA,SAAKH,KAAL,CAAW6C,MAAX,GAAoB,KAAK7C,KAAL,CAAWI,GAA/B;AACA,SAAKJ,KAAL,CAAW2C,OAAX,GAAqB,KAAK3C,KAAL,CAAWE,IAAhC;AACH;;AAEDkD,EAAAA,YAAY,CAACW,IAAD,EAAO;AACf,QAAIR,QAAQ,GAAGC,QAAQ,CAACC,sBAAT,CAAgC,MAAhC,CAAf;AACAF,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,CAACK,IAAxB,CAFe,CAEc;;AAC7BR,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,CAACK,IAAxB,CAHe,CAGc;;AAC7BR,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,CAACK,IAAxB,CAJe,CAIc;;AAC7BR,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,CAACK,IAAxB,CALe,CAKc;;AAC7BR,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuB,CAACK,IAAxB,CANe,CAMc;;AAC7BR,IAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYG,QAAZ,GAAuBK,IAAvB,CAPe,CAOc;AAChC;;AA4DDV,EAAAA,UAAU,CAACjD,GAAD,EAAM;AACZA,IAAAA,GAAG,GAAGA,GAAG,CAAC4D,OAAJ,CAAY,SAAZ,EAAuB,EAAvB,CAAN;AACA,QAAIC,GAAJ;AACA,QAAIC,GAAJ;AAEA,QAAI9D,GAAG,IAAI,EAAX,EAAe,OAAO,KAAP;AAEf,QAAIA,GAAG,CAAC+D,MAAJ,IAAc,EAAd,IACA/D,GAAG,IAAI,aADP,IAEAA,GAAG,IAAI,aAFP,IAGAA,GAAG,IAAI,aAHP,IAIAA,GAAG,IAAI,aAJP,IAKAA,GAAG,IAAI,aALP,IAMAA,GAAG,IAAI,aANP,IAOAA,GAAG,IAAI,aAPP,IAQAA,GAAG,IAAI,aARP,IASAA,GAAG,IAAI,aATP,IAUAA,GAAG,IAAI,aAVX,EAWI,OAAO,KAAP;AAEJ8D,IAAAA,GAAG,GAAG,CAAN;;AACA,SAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EACIF,GAAG,IAAIG,QAAQ,CAACjE,GAAG,CAACkE,MAAJ,CAAWF,CAAX,CAAD,CAAR,IAA2B,KAAKA,CAAhC,CAAP;;AACJH,IAAAA,GAAG,GAAG,KAAMC,GAAG,GAAG,EAAlB;AACA,QAAID,GAAG,IAAI,EAAP,IAAaA,GAAG,IAAI,EAAxB,EACIA,GAAG,GAAG,CAAN;AACJ,QAAIA,GAAG,IAAII,QAAQ,CAACjE,GAAG,CAACkE,MAAJ,CAAW,CAAX,CAAD,CAAnB,EACI,OAAO,KAAP;AAEJJ,IAAAA,GAAG,GAAG,CAAN;;AACA,SAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EACIF,GAAG,IAAIG,QAAQ,CAACjE,GAAG,CAACkE,MAAJ,CAAWF,CAAX,CAAD,CAAR,IAA2B,KAAKA,CAAhC,CAAP;;AACJH,IAAAA,GAAG,GAAG,KAAMC,GAAG,GAAG,EAAlB;AACA,QAAID,GAAG,IAAI,EAAP,IAAaA,GAAG,IAAI,EAAxB,EACIA,GAAG,GAAG,CAAN;AACJ,QAAIA,GAAG,IAAII,QAAQ,CAACjE,GAAG,CAACkE,MAAJ,CAAW,EAAX,CAAD,CAAnB,EACI,OAAO,KAAP;AACJ,WAAO,IAAP;AACH;;AAEDC,EAAAA,MAAM,GAAG;AAEL,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,SAAD;AAAW,MAAA,SAAS,EAAC,SAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,GAAD;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAC,IAAR;AAAa,MAAA,EAAE,EAAC,IAAhB;AAAqB,MAAA,EAAE,EAAC,IAAxB;AAA6B,MAAA,EAAE,EAAC,IAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAI,MAAA,EAAE,EAAC,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,CADJ,CADJ,EAOI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAC,IAAR;AAAa,MAAA,EAAE,EAAC,IAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,IAAD;AAAM,MAAA,EAAE,EAAC,QAAT;AAAkB,MAAA,SAAS,EAAC,sBAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,SAAD;AAAW,MAAA,SAAS,EAAC,+BAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,8BAAf;AAA8C,MAAA,KAAK,EAAC,OAApD;AAA4D,MAAA,MAAM,EAAC,OAAnE;AAA2E,MAAA,GAAG,EAAE,KAAKvE,KAAL,CAAWE,IAA3F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,EAKI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,MAAZ;AAAmB,MAAA,SAAS,EAAC,mBAA7B;AAAiD,MAAA,QAAQ,EAAE,KAAKS,UAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAGI,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAC,UAAb;AAAwB,MAAA,KAAK,EAAC,SAA9B;AAAwC,MAAA,SAAS,EAAC,UAAlD;AAA6D,MAAA,KAAK,EAAE,KAAKX,KAAL,CAAW2B,QAA/E;AAAyF,MAAA,GAAG,EAAC,KAA7F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHJ,CALJ,EAWI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,GAAG,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,EAEI,oBAAC,KAAD;AAAO,MAAA,EAAE,EAAC,MAAV;AAAiB,MAAA,IAAI,EAAC,MAAtB;AAA6B,MAAA,SAAS,EAAC,oBAAvC;AAA4D,MAAA,KAAK,EAAE,KAAK3B,KAAL,CAAWG,IAA9E;AAAoF,MAAA,QAAQ,EAAGS,CAAD,IAAO,KAAKP,QAAL,CAAc;AAAEF,QAAAA,IAAI,EAAES,CAAC,CAACC,MAAF,CAAS0B;AAAjB,OAAd,CAArG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CAXJ,EAgBI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,GAAG,EAAC,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADJ,EAEI,oBAAC,SAAD;AAAW,MAAA,EAAE,EAAC,KAAd;AAAoB,MAAA,SAAS,EAAC;AAA9B,OAAmE,KAAKvC,KAAxE;AAA+E,MAAA,QAAQ,EAAE,KAAKqC,QAA9F;AAAwG,MAAA,EAAE,EAAC,KAA3G;AAAiH,MAAA,KAAK,EAAE,KAAKrC,KAAL,CAAWI,GAAnI;AACI,MAAA,YAAY,EAAC,KADjB;AACuB,MAAA,WAAW,EAAC,gBADnC;AACoD,MAAA,QAAQ,MAD5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAFJ,CAhBJ,EAsBI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAC,IAAR;AAAa,MAAA,EAAE,EAAC,EAAhB;AAAmB,MAAA,EAAE,EAAC,GAAtB;AAA0B,MAAA,SAAS,EAAC,kBAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAC,SAAd;AAAwB,MAAA,SAAS,EAAC,YAAlC;AACI,MAAA,OAAO,EAAGQ,CAAD,IAAQ,KAAKsC,MAAL,CAAY,KAAZ,CADrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,CADA,EAKA,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAC,IAAR;AAAa,MAAA,EAAE,EAAC,GAAhB;AAAoB,MAAA,EAAE,EAAC,GAAvB;AAA2B,MAAA,SAAS,EAAC,kBAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAC,QAAd;AAAuB,MAAA,SAAS,EAAC,YAAjC;AACI,MAAA,OAAO,EAAGtC,CAAD,IAAO;AAAE,aAAKuC,QAAL,CAAc,KAAd;AAAsB,OAD5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,CALA,EASA,oBAAC,GAAD;AAAK,MAAA,EAAE,EAAC,IAAR;AAAa,MAAA,EAAE,EAAC,GAAhB;AAAoB,MAAA,EAAE,EAAC,GAAvB;AAA2B,MAAA,SAAS,EAAC,kBAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAQ,MAAA,KAAK,EAAC,SAAd;AAAwB,MAAA,SAAS,EAAC,YAAlC;AACI,MAAA,OAAO,EAAGvC,CAAD,IAAQ,KAAKoC,OAAL,CAAa,IAAb,CADrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADJ,CATA,CADJ,CAtBJ,CADJ,CADJ,CAPJ,CADJ,CADJ;AAuDH;;AAnQ0B;;AAsQ/B,eAAexD,MAAf","sourcesContent":["import React, { Component } from 'react';\nimport firebase from '../../firebase';\nimport { Container, Row, Col, Button, Input, Label, Progress, Form, FormGroup } from 'reactstrap';\nimport InputMask from 'react-input-mask';\nimport './perfil.css';\nclass Perfil extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            mask: '999.999.999-99',\n            foto: null,\n            nome: '',\n            cpf: '',\n            fotoOld: '',\n            nomeOld: '',\n            cpfOld: '',\n            email: firebase.getCurrent(),\n            uid: firebase.getCurrentUid(),\n            progress: 0\n        }\n        this.alterar = this.alterar.bind(this)\n        this.salvar = this.salvar.bind(this)\n        this.cancelar = this.cancelar.bind(this)\n        this.controlaTela = this.controlaTela.bind(this)\n        this.update = this.update.bind(this)\n        this.handleFile = this.handleFile.bind(this)\n        this.handleUpload = this.handleUpload.bind(this)\n        this.validarCPF = this.validarCPF.bind(this)\n    }\n\n    async componentDidMount() {\n\n        let elements = document.getElementsByClassName('edit')\n        elements[0].disabled = true //Input File\n        elements[1].disabled = true //Input Name\n        elements[2].disabled = true //Input CPF\n        elements[3].disabled = true //Button Salvar\n        elements[4].disabled = true //Button Cancelar\n        console.log(elements)\n\n        firebase.getUserName((info) => {\n            localStorage.nome = info.val().nome\n            localStorage.cpf = info.val().cpf\n            localStorage.foto = info.val().foto\n            this.setState({ nome: localStorage.nome, foto: localStorage.foto, cpf: localStorage.cpf })\n        })\n    }\n\n    update = async () => {\n        let users = firebase.app.ref('usuarios');\n\n        try {\n            await users.child(this.state.uid).update({\n                foto: this.state.foto,\n                nome: this.state.nome,\n                cpf: this.state.cpf\n            })\n            this.setState(this.state)\n            // alert(\"Seus dados foram salvos com sucesso!\")\n            window.location.reload();\n        } catch (error) {\n            alert(\"Ocorreu um erro ao alterar seus dados!\")\n        }\n    }\n\n    salvar(e) {\n        this.controlaTela(e)\n        if (this.validarCPF(this.state.cpf)) {\n            this.update()\n        }\n        else {\n            alert(\"CPF Inválido!\")\n            this.setState({\n                foto: this.state.fotoOld,\n                nome: this.state.nomeOld,\n                cpf: this.state.cpfOld\n            })\n        }\n    }\n\n    cancelar(e) {\n        this.setState({ progress: 0 })\n\n        this.controlaTela(e)\n        this.setState({\n            foto: this.state.fotoOld,\n            nome: this.state.nomeOld,\n            cpf: this.state.cpfOld\n        })\n    }\n\n    alterar(e) {\n        this.controlaTela(e)\n        this.state.nomeOld = this.state.nome\n        this.state.cpfOld = this.state.cpf\n        this.state.fotoOld = this.state.foto\n    }\n\n    controlaTela(cond) {\n        let elements = document.getElementsByClassName('edit')\n        elements[0].disabled = !cond //Input File\n        elements[1].disabled = !cond //Input Nome\n        elements[2].disabled = !cond //Input CPF\n        elements[3].disabled = !cond //Button Salvar\n        elements[4].disabled = !cond //Button Cancelar\n        elements[5].disabled = cond  //Button Alterar\n    }\n\n\n    handleFile = async (e) => {\n\n        if (e.target.files[0]) {\n            const image = e.target.files[0];\n\n            if (image.type === \"image/png\" || image.type === \"image/jpeg\") {\n                await this.setState({ imagem: image });\n                this.handleUpload();\n            } else {\n                alert('Envie uma imagem do tipo PNG ou JPEG');\n                this.setState({ imagem: null });\n                return null;\n            }\n        }\n    }\n\n    handleUpload = async () => {\n        const { imagem } = this.state;\n        const currentUid = firebase.getCurrentUid();\n        const uploadTask = firebase.storage\n            .ref(`images/${currentUid}/${imagem.name}`)\n            .put(imagem);\n\n        await uploadTask.on('state_changed',\n            (snapshot) => {\n                //Progress\n                const progress = Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100);\n                this.setState({ progress: progress });\n            },\n            (error) => {\n                //Error\n                console.log('Error imagem: ' + error);\n            },\n            () => {\n                //Sucessful\n                firebase.storage.ref(`images/${currentUid}`)\n                    .child(imagem.name)\n                    .getDownloadURL()\n                    .then(url => {\n                        this.setState({ foto: url });\n                    })\n            })\n    }\n\n    onChange = (event) => {\n        var value = event.target.value;\n        var newState = {\n            mask: '999.999.999-99',\n            value: value\n        };\n        if (/^3[47]/.test(value)) {\n            newState.mask = '999.999.999-99';\n        }\n        this.setState(newState);\n        this.setState({ cpf: event.target.value });\n    }\n\n    validarCPF(cpf) {\n        cpf = cpf.replace(/[^\\d]+/g, '');\n        let rev;\n        let add;\n\n        if (cpf == '') return false;\n\n        if (cpf.length != 11 ||\n            cpf == \"00000000000\" ||\n            cpf == \"11111111111\" ||\n            cpf == \"22222222222\" ||\n            cpf == \"33333333333\" ||\n            cpf == \"44444444444\" ||\n            cpf == \"55555555555\" ||\n            cpf == \"66666666666\" ||\n            cpf == \"77777777777\" ||\n            cpf == \"88888888888\" ||\n            cpf == \"99999999999\")\n            return false;\n\n        add = 0;\n        for (let i = 0; i < 9; i++)\n            add += parseInt(cpf.charAt(i)) * (10 - i);\n        rev = 11 - (add % 11);\n        if (rev == 10 || rev == 11)\n            rev = 0;\n        if (rev != parseInt(cpf.charAt(9)))\n            return false;\n\n        add = 0;\n        for (let i = 0; i < 10; i++)\n            add += parseInt(cpf.charAt(i)) * (11 - i);\n        rev = 11 - (add % 11);\n        if (rev == 10 || rev == 11)\n            rev = 0;\n        if (rev != parseInt(cpf.charAt(10)))\n            return false;\n        return true;\n    }\n\n    render() {\n\n        return (\n            <div>\n                <Container className=\"mx-auto\">\n                    <Row className=\"mt-5\">\n                        <Col xs='12' sm='12' md='12' lg='12'>\n                            <h5 id=\"title\">Meu Perfil</h5>\n                        </Col>\n                    </Row>\n\n                    <Row>\n                        <Col md='12' lg='12'>\n                            <Form id=\"perfil\" className=\"my-2 mx-auto rounded\">\n                                <FormGroup className=\"d-flex justify-content-center\">\n                                    <img className='rounded-circle my-1 myBorder' width='200px' height='200px' src={this.state.foto} />\n                                </FormGroup>\n\n                                <FormGroup>\n                                    <Input type=\"file\" className=\"edit mx-auto my-3\" onChange={this.handleFile} />\n\n                                    <Progress id='progress' color=\"success\" className=\" mx-auto\" value={this.state.progress} max=\"100\" />\n                                </FormGroup>\n\n                                <FormGroup>\n                                    <Label for=\"nome\">Nome</Label>\n                                    <Input id='nome' type='text' className=' my-1 mx-auto edit' value={this.state.nome} onChange={(e) => this.setState({ nome: e.target.value })} />\n                                </FormGroup>\n\n                                <FormGroup>\n                                    <Label for=\"cpf\">CPF</Label>\n                                    <InputMask id='cpf' className=\"form-control my-1 mx-auto edit\" {...this.state} onChange={this.onChange} id=\"cpf\" value={this.state.cpf}\n                                        autoComplete=\"off\" placeholder=\"000.000.000-00\" required />\n                                </FormGroup>\n\n                                <FormGroup>\n                                    <Row>\n                                    <Col sm='12' md='' lg='4' className=\"text-center my-3\">\n                                        <Button color=\"success\" className=\"edit w-100\"\n                                            onClick={(e) => (this.salvar(false))}>Salvar</Button>\n                                    </Col>\n                                    <Col sm='12' md='4' lg='4' className=\"text-center my-3\">\n                                        <Button color=\"danger\" className=\"edit w-100\"\n                                            onClick={(e) => { this.cancelar(false) }}>Cancelar</Button>\n                                    </Col>\n                                    <Col sm='12' md='4' lg='4' className=\"text-center my-3\">\n                                        <Button color=\"warning\" className='edit w-100'\n                                            onClick={(e) => (this.alterar(true))}>Alterar</Button>\n                                    </Col>\n                                    </Row>\n                                </FormGroup>\n                            </Form>\n                        </Col>\n                    </Row>\n                </Container>\n            </div >\n        );\n    }\n}\n\nexport default Perfil;"]},"metadata":{},"sourceType":"module"}